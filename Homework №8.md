## Домашняя работа №8

1. Выполнение домашнего задания проводилось на сервере под управлением PostgreSQL 15. Версия ОС Debian 12.
2. Первым делом изменена настройка частоты выполнения контрольной точки, а именно изменена строка в конфиге: 
```bash
checkpoint_timeout = 30
```
3. Создана тестовая база данных, в нее проинициализированы первоначальные данные данные при помощи pgbench.
```bash
pgbench -i test
```
4. Для дальнейшего анализа определил текущий LSN до момента подачи нагрузки через pgbench.
```sql
select pg_current_wal_lsn();
```
5. После подачи нагрузки в течение 10 минут определил текущий LSN еще раз и сравнил их при помощи
```sql
select '0/147EA640'::pg_lsn - '0/147EA858'::pg_lsn as bytes;
```
6. В итоге разница составила 291МБ. В представлении ```pg_stat_bgwriter``` отклонений от нормы выполнения контрольных точек не обнаружил. 
7. Далее был проведен повторный тест, но уже в ассинхронном режиме. В этом случае результат был идентичный. Контрольные точки выполнились как положено, разница между LSN составила 289МБ и значения tps были на одном уровне в обоих тестах. Я полагаю, что объем данных в БД слишком мал, чтобы кардинально повлиять на результаты тестов. Однако замечу, что в синхронном режиме время отклика выше, так как выше надежность, поэтому на более "жирных" базах разницу было бы видно более отчетливо.
8. Для выполнения последнего пункта был создан кластер с включенными чексуммами, создана таблица с данными. В данном пункте так же было проведено 2 теста.
 - В первом случае я удалил 1 служебный знак из файла таблицы. Запрос по таблице, очевидно, выдал ошибку целостности данных. Проигнорировать эту ошибку можно при помощи команды ```SET ignore_checksum_failure=on;```. На этом этапе запрос выводится, но опять же с оговоркой ```WARNING:  page verification failed, calculated checksum 44036 but expected 42716```.
 - Во втором я изменил в файле таблицы именно значения данных, которые вставлял. В этом случае проигнорировать ошибку не получится. В описании вышеупомянутой команды есть такие строки "Если же повреждён заголовок, будет выдана ошибка, даже когда этот параметр включён". На практике все так и было.
 - Вариантом решения проблемы является резервное копирование данных, но в рамках этого примера я его не делал.
